<?xml version="1.0" encoding="utf-8"?>

<feed xmlns="http://www.w3.org/2005/Atom" >
  <generator uri="https://jekyllrb.com/" version="3.7.4">Jekyll</generator>
  <link href="https://darrynbrownfield.co.uk/tag/intigriti/feed.xml" rel="self" type="application/atom+xml" />
  <link href="https://darrynbrownfield.co.uk/" rel="alternate" type="text/html" />
  <updated>2022-08-21T10:52:11+00:00</updated>
  <id>https://darrynbrownfield.co.uk/tag/intigriti/feed.xml</id>

  
  
  

  
    <title type="html">Darryn Brownfield | </title>
  

  
    <subtitle>Infosec | Hacking | CTF</subtitle>
  

  

  
    
      
    
  

  
  

  
    <entry>
      <title type="html">Intigriti 1337UP CTF 2022</title>
      <link href="https://darrynbrownfield.co.uk/intigritictf" rel="alternate" type="text/html" title="Intigriti 1337UP CTF 2022" />
      <published>2022-03-12T00:00:00+00:00</published>
      <updated>2022-03-12T00:00:00+00:00</updated>
      <id>https://darrynbrownfield.co.uk/intigritictf</id>
      <content type="html" xml:base="https://darrynbrownfield.co.uk/intigritictf">&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/cover.gif&quot; alt=&quot;cover&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;overview&quot;&gt;Overview&lt;/h3&gt;

&lt;p&gt;These are a few write ups from the 1337UP CTF hosted by [Intigriti]](https://www.intigriti.com). It was a 24 hour CTF so didn’t get as much time on it as I would have liked however it was still a lot of fun.&lt;/p&gt;

&lt;h1 id=&quot;mirage---misc&quot;&gt;Mirage - Misc&lt;/h1&gt;

&lt;p&gt;The link for the ‘Mirage’ challenge was https://mirage.ctf.intigriti.io/. There were no additional files with this challenge. Looking at the website was just a static page with no working links.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/mirage.png&quot; alt=&quot;mirage&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I looked at /robots.txt and found a whole list of entries.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/miragerobots.png&quot; alt=&quot;miragerobots&quot; /&gt;&lt;/p&gt;

&lt;p&gt;There are a few entires that lead no where and a some are trolls, the important ones are:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-highlight&quot;&gt;Disallow: /wordlists.txt
Disallow: /ok.txt
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;I used &lt;code class=&quot;highlighter-rouge&quot;&gt;wget https://mirage.ctf.intigriti.io/wordlists.txt&lt;/code&gt; to download the wordlist to my machine. On /ok.txt is some text which includes ‘/uncclzrny.wct’ with a hint of using ROT.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/mirageok.png&quot; alt=&quot;mirageok&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I went over to &lt;a href=&quot;https://gchq.github.io/CyberChef/&quot;&gt;CyberChef&lt;/a&gt; and used rot13 on the text. This provided the url ‘/happymeal.jpg’.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/cyberchefrot.png&quot; alt=&quot;cyberchefrot&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This led to another page ‘HelpMeOut.txt’.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/miragehelp.png&quot; alt=&quot;miragehelp&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This page provides a link to a download. Again using wget I download the zip file.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/miragedownload.png&quot; alt=&quot;miragedownload&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The zip is password protected.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-highlight&quot;&gt;└──╼ $unzip flag.zip 
Archive:  flag.zip
[flag.zip] flag.txt password: 
   skipping: flag.txt                incorrect password
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;I used zip2john to create a hash.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-highlight&quot;&gt;└──╼ $zip2john flag.zip &amp;gt; zip.john                                                                          
ver 1.0 efh 5455 efh 7875 flag.zip/flag.txt PKZIP Encr: 2b chk, TS_chk, cmplen=68, decmplen=56, crc=CC303849
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then use john to crack the hash with the word list downloaded earlier.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-highlight&quot;&gt;└──╼ $john --wordlist=wordlists.txt zip.john 
Using default input encoding: UTF-8
Loaded 1 password hash (PKZIP [32/64])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
Soeasypeasy214   (flag.zip/flag.txt)
1g 0:00:00:00 DONE (2022-03-11 20:32) 100.0g/s 15500p/s 15500c/s 15500C/s ##this will help you later..violent
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed
┌─[daz@parrotos]─[~/Documents/1337UPCTF/Mirage]
└──╼ $unzip flag.zip 
Archive:  flag.zip
[flag.zip] flag.txt password: 
 extracting: flag.txt                
┌─[daz@parrotos]─[~/Documents/1337UPCTF/Mirage]
└──╼ $cat flag.txt 
1337UP{Wh4tAM3ss.txt.jpg.whyareyouputtingmethroughthis}
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&quot;traveler---web&quot;&gt;Traveler - Web&lt;/h1&gt;

&lt;p&gt;The link for the ‘Traveler’ challenge was https://traveller.ctf.intigriti.io/. There were no additional files with this challenge. Looking at the link its a travel agent based website.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/traveler.png&quot; alt=&quot;traveler&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Poking around the website I found a section to check availability.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/travelerinjection.png&quot; alt=&quot;travelerinjection&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I sent the request to Burp and started fuzzing the pack name field.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/travelerapi.png&quot; alt=&quot;travelerapi&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When submitting &lt;code class=&quot;highlighter-rouge&quot;&gt;Single'&lt;/code&gt;  an error was generated showing&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;An error occurred whilst executing: bash check.sh Couple’&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/travelererror.png&quot; alt=&quot;travelererror&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It doesn’t appear to be verifying user input so I should be able to just append bash commands to the syntax so I tried &lt;code class=&quot;highlighter-rouge&quot;&gt;Single&amp;amp;ls&lt;/code&gt; because of the special character I URL encoded it.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/travelerls.png&quot; alt=&quot;travelerls&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It worked, so getting the flag was simple using the payload &lt;code class=&quot;highlighter-rouge&quot;&gt;pack=Single%26%63%61%74%20%2e%2e%2f%2e%2e%2f%2e%2e%2f%66%6c%61%67%2e%74%78%74&amp;amp;submit=Submit&lt;/code&gt; which is &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;amp;cat ../../../flag.txt&lt;/code&gt; URL encoded.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/travelerflag.png&quot; alt=&quot;travelerflag&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;lovely-kitten-pictures-1---lovely-kitten-pictures&quot;&gt;Lovely Kitten Pictures 1 - Lovely Kitten Pictures&lt;/h1&gt;

&lt;p&gt;The link for the ‘Lovely Kitten Pictures 1’ challenge was https://lovelykittenpictures.ctf.intigriti.io/. No files were included as part of this challenge. Navigating to the website just showed a picture of a cat with an option to switch.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/cats.png&quot; alt=&quot;cats&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I sent the requests through Burp and saw a request to ‘/pictures.php?path=assets/1.jpg’. That looks it could be vulnerable to an LFI (Local File Inclusion).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/catsassets.png&quot; alt=&quot;catsassets&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I played around for a while trying the basics such as ../../../../flag.txt, ../../../../etc/passwd &amp;amp; etc but just got 404’s so decided to try ‘/pictures.php?path=pictures.php’ which if it worked would include the source code of the php file and I would be able to see how the request worked and it worked!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/intigritictf/catsflag.png&quot; alt=&quot;catsflag&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Reading the code it looks like any file other than .jpg would return the contents of flag1.txt I look at the headers and the flag was included1.&lt;/p&gt;

&lt;p&gt;Thanks for reading!&lt;/p&gt;

&lt;p&gt;==========================================================================&lt;/p&gt;

&lt;p&gt;Any comments or feedback welcome! You can find me on &lt;a href=&quot;https://twitter.com/dazbrownfield&quot;&gt;twitter&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.buymeacoffee.com/dazbrownfield&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://cdn.buymeacoffee.com/buttons/v2/default-blue.png&quot; alt=&quot;Buy Me A Coffee&quot; style=&quot;height: 60px !important;width: 217px !important;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Darryn</name>
        
        
      </author>

      

      
        <category term="intigriti" />
      
        <category term="ctf" />
      

      
        <summary type="html"></summary>
      

      
      
    </entry>
  
</feed>
